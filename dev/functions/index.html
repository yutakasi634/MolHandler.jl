<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Functions · MolHandler.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">MolHandler.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Top</a></li><li class="is-active"><a class="tocitem" href>Functions</a><ul class="internal"><li><a class="tocitem" href="#Index-1"><span>Index</span></a></li><li><a class="tocitem" href="#File-IO-1"><span>File IO</span></a></li><li><a class="tocitem" href="#Trajectory-handling-1"><span>Trajectory handling</span></a></li><li><a class="tocitem" href="#Utility-1"><span>Utility</span></a></li></ul></li><li><a class="tocitem" href="../structs/">Structs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Functions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/yutakasi634/MolHandler.jl/blob/master/docs/src/functions.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Functions-1"><a class="docs-heading-anchor" href="#Functions-1">Functions</a><a class="docs-heading-anchor-permalink" href="#Functions-1" title="Permalink"></a></h1><h2 id="Index-1"><a class="docs-heading-anchor" href="#Index-1">Index</a><a class="docs-heading-anchor-permalink" href="#Index-1" title="Permalink"></a></h2><ul><li><a href="#MolHandler.atom_mass"><code>MolHandler.atom_mass</code></a></li><li><a href="#MolHandler.center_of_mass"><code>MolHandler.center_of_mass</code></a></li><li><a href="#MolHandler.clip_trajectory"><code>MolHandler.clip_trajectory</code></a></li><li><a href="#MolHandler.contact_bool_matrix"><code>MolHandler.contact_bool_matrix</code></a></li><li><a href="#MolHandler.contact_bool_matrix_parallel"><code>MolHandler.contact_bool_matrix_parallel</code></a></li><li><a href="#MolHandler.contact_probability_matrix"><code>MolHandler.contact_probability_matrix</code></a></li><li><a href="#MolHandler.contact_probability_matrix_parallel"><code>MolHandler.contact_probability_matrix_parallel</code></a></li><li><a href="#MolHandler.get_atom"><code>MolHandler.get_atom</code></a></li><li><a href="#MolHandler.get_frame"><code>MolHandler.get_frame</code></a></li><li><a href="#MolHandler.pair_length_matrix"><code>MolHandler.pair_length_matrix</code></a></li><li><a href="#MolHandler.pair_length_matrix_parallel"><code>MolHandler.pair_length_matrix_parallel</code></a></li><li><a href="#MolHandler.radius_of_gyration"><code>MolHandler.radius_of_gyration</code></a></li><li><a href="#MolHandler.read_dcd"><code>MolHandler.read_dcd</code></a></li><li><a href="#MolHandler.read_pdb"><code>MolHandler.read_pdb</code></a></li><li><a href="#MolHandler.write_dcd"><code>MolHandler.write_dcd</code></a></li><li><a href="#MolHandler.write_pdb"><code>MolHandler.write_pdb</code></a></li></ul><h2 id="File-IO-1"><a class="docs-heading-anchor" href="#File-IO-1">File IO</a><a class="docs-heading-anchor-permalink" href="#File-IO-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MolHandler.read_dcd" href="#MolHandler.read_dcd"><code>MolHandler.read_dcd</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">read_dcd(filename::String)::Trajectory</code></pre><p>Return Trajectory object which filled <code>coordinates</code>, <code>nframe</code>, <code>natom</code> fields.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/fileio.jl#L4-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MolHandler.write_dcd" href="#MolHandler.write_dcd"><code>MolHandler.write_dcd</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">write_dcd(filename::String, trj::Trajectory;
          save_step::Integer = 1, total_step::Integer = trj.nframe,
          unit_num::Integer  = 1,  time_step::Real = 1.0f0)</code></pre><p>Write <code>coordinates</code>, <code>nframe</code> and <code>natom</code> infomation of <code>trj</code> to dcd file, named <code>filename</code>. dcd file contain other information - save interval step, unit(chain) number in the system, total step and time step of original trajectory -, and if you do not specify these parameter, these are filled with default value.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/fileio.jl#L96-L103">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MolHandler.read_pdb" href="#MolHandler.read_pdb"><code>MolHandler.read_pdb</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">read_pdb(filename::AbstractString; model = :unspecified)::Trajectory</code></pre><p>Return Trajectory object which filled all field. If you set <code>:AA</code> to model field, this function set the mass of particle based on atomname field. If you set <code>:CA</code> to model field, this function set the mass of particcle mase on resname field.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/fileio.jl#L162-L168">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MolHandler.write_pdb" href="#MolHandler.write_pdb"><code>MolHandler.write_pdb</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">write_pdb(filename::AbstractString, trj::Trajectory;
          tempfactor::Union{RealT, Nothing} = nothing) where RealT &lt;: Real</code></pre><p>Write <code>coordinates</code>, <code>resname</code>, <code>resid</code>, <code>atomname</code>, <code>atomid</code> to <code>filename</code> based on <code>trj</code>. If you set Real value to <code>tempfactor</code>, all tempfactor will be field with that value.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/fileio.jl#L204-L210">source</a></section></article><h2 id="Trajectory-handling-1"><a class="docs-heading-anchor" href="#Trajectory-handling-1">Trajectory handling</a><a class="docs-heading-anchor-permalink" href="#Trajectory-handling-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MolHandler.get_frame" href="#MolHandler.get_frame"><code>MolHandler.get_frame</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">get_frame(frame_idx::Int64, trajectory::Trajectory)
::Frame</code></pre><p>Return Frame object which correspond to <code>framd_idx</code> frame from <code>trajectory</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MolHandler.get_atom" href="#MolHandler.get_atom"><code>MolHandler.get_atom</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">get_atom(query::Int64, trajectory::Trajectory)
::Vector{Atom}</code></pre><p>Return Vector of <code>query</code>th Atom object from <code>trajectory</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L13-L18">source</a></section><section><div><pre><code class="language-none">get_atom(query::Int64, frame::Frame)
::Atom</code></pre><p>Return <code>query</code>th Atom object from <code>frame</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L23-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MolHandler.clip_trajectory" href="#MolHandler.clip_trajectory"><code>MolHandler.clip_trajectory</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">clip_trajectory(query::Union{Integer, Array{T, 1}, OrdinalRange}, trj::Trajectory;
                query_key::Symbol = :frame)
::Trajecotory where T &lt;: Integer</code></pre><p>Clip a part of trajectory you specified. Expected query key is one of the following</p><ul><li><code>:frame</code> : in this case, query specify the frame index.</li><li><code>:atom</code>  : in this case, query specify the atom index.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L34-L44">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MolHandler.center_of_mass" href="#MolHandler.center_of_mass"><code>MolHandler.center_of_mass</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">center_of_mass(query::Trajectory;
               frame_indices::Union{Array, OrdinalRange, Colon} = :,
               atom_indices::Union{Array, OrdinalRange, Colon} = :,
               geometric::Bool = false)
::Vector{Coordinate{Real}}</code></pre><p>Calculate the center of mass of trajectory for specified frame and atom indices. If you set <code>geometric</code> is <code>true</code>, this function calculate geometric center of mass.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L77-L86">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MolHandler.radius_of_gyration" href="#MolHandler.radius_of_gyration"><code>MolHandler.radius_of_gyration</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">radius_of_gyration(trj::Trajectory;
                   frame_indices::Union{Array, OrdinalRange, Colon} = :,
                   atom_indices ::Union{Array, OrdinalRange, Colon} = :)
::Vector{Real}</code></pre><p>Calculate radius of gyration over the trajectory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L323-L330">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MolHandler.pair_length_matrix" href="#MolHandler.pair_length_matrix"><code>MolHandler.pair_length_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">pair_length_matrix(corrds1::Vector{Coordinate}, coords2::Vector{Coordinate})
::Matrix{Coordinate}</code></pre><p>Calculate distance matrix for all combination between <code>coords1</code> and <code>coord2</code>. The row of returned matrix coresspond to <code>coords1</code>, and the column correspond to <code>coords2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L109-L115">source</a></section><section><div><pre><code class="language-none">pair_length_matrix(trj::Trajectory;
                   frame_indices::Union{Array, OrdinalRange, Colon}       = :,
                   first_atom_indices::Union{Array, OrdinalRange, Colon}  = :,
                   second_atom_indices::Union{Array, OrdinalRange, Colon} = atom_indices1)
::Vector{Matrix{Coordinate}}</code></pre><p>Calculate distance matrix for all combination between <code>first_atom_indices</code> and <code>second_atom_indices</code>. This cauculation apply to each frame of trajectory and the result matrices are stored in Vector. The target frame can be restricted by pass indeces vector or range to <code>frame_indices</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L121-L131">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MolHandler.contact_bool_matrix" href="#MolHandler.contact_bool_matrix"><code>MolHandler.contact_bool_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">contact_bool_matrix(threshold::Real, trj::Trajectory;
                    frame_indices::Union{Array, OrdinalRange, Colon}       = :,
                    first_atom_indices::Union{Array, OrdinalRange, Colon}  = :,
                    second_atom_indices::Union{Array, OrdinalRange, Colon} = first_atom_indices)
::Vector{Matrix{Bool}}</code></pre><p>Judge contact is formed or not. If the distance between two coordinate is shorter than threshold, contact is considered to be formed. In returned matrix, the row of matrices corresponds to first<em>atom</em>indices and column of matrices corresponds to second<em>atom</em>indices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L165-L173">source</a></section><section><div><pre><code class="language-none">contact_bool_matrix(threshold::Real, trj::Trajectory;
                    frame_indices::Union{Array, OrdinalRange, Colon}       = :,
                    first_atom_indices::Union{Array, OrdinalRange, Colon}  = :,
                    second_atom_indices::Union{Array, OrdinalRange, Colon} = first_atom_indices)
::Vector{Matrix{Bool}}</code></pre><p>Judge contact is formed or not. If the distance between two coordinate is shorter than threshold, contact is considered to be formed. In returned vector of matrices, each matrix correspond to contact matrix of each frame. You can specify the target frames or atoms by <code>frame_indices</code>, <code>first_atom_indices</code> or <code>second_atom_indices</code>. When you specify the target atoms, the row of matrices corresponds to first<em>atom</em>indices and column of matrices corresponds to second<em>atom</em>indices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L181-L190">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MolHandler.contact_probability_matrix" href="#MolHandler.contact_probability_matrix"><code>MolHandler.contact_probability_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">contact_probability_matrix(threshold::Real, trj::Trajectory;
                           frame_indices::Union{Array, OrdinalRange, Colon}       = :,
                           first_atom_indices::Union{Array, OrdinalRange, Colon}  = :,
                           second_atom_indices::Union{Array, OrdinalRange, Colon} = first_atom_indices)
::Matrix{Real}</code></pre><p>Calculate contact formation probability over the trajectory. If the distance between two coordinate is shorter than threshold, contact is considered to be formed. You can specify the target frames or atoms by <code>frame_indices</code>, <code>first_atom_indices</code> or <code>second_atom_indices</code>. When you specify the target atoms, the row of matrices corresponds to first<em>atom</em>indices and column of matrices corresponds to second<em>atom</em>indices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L282-L291">source</a></section></article><h2 id="Utility-1"><a class="docs-heading-anchor" href="#Utility-1">Utility</a><a class="docs-heading-anchor-permalink" href="#Utility-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MolHandler.atom_mass" href="#MolHandler.atom_mass"><code>MolHandler.atom_mass</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">atom_mass(name::AbstractString)
::Float32</code></pre><p>Return mass of the <code>name</code> atom. The kind of each atom is judged by PDB format atom names rule. https://cdn.rcsb.org/wwpdb/docs/documentation/file-format/PDB<em>format</em>1992.pdf</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L349-L356">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>residue_mass</code>. Check Documenter&#39;s build log for details.</p></div></div><h3 id="Multi-Threading-1"><a class="docs-heading-anchor" href="#Multi-Threading-1">Multi-Threading</a><a class="docs-heading-anchor-permalink" href="#Multi-Threading-1" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MolHandler.pair_length_matrix_parallel" href="#MolHandler.pair_length_matrix_parallel"><code>MolHandler.pair_length_matrix_parallel</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">pair_length_matrix_parallel(trj::Trajectory;
                            frame_indices::Union{Array, OrdinalRange, Colon}       = :,
                            first_atom_indices::Union{Array, OrdinalRange, Colon}  = :,
                            second_atom_indices::Union{Array, OrdinalRange, Colon} = atom_indices1)
::Vector{Matrix{Coordinate}}</code></pre><p>Multi-threads version of pair<em>length</em>matrix. If you set available threads number to <code>Threads.nthreads()</code>, this function would faster than non-parallel version.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L141-L149">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MolHandler.contact_bool_matrix_parallel" href="#MolHandler.contact_bool_matrix_parallel"><code>MolHandler.contact_bool_matrix_parallel</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">contact_bool_matrix_parallel(threshold::Real, trj::Trajectory;
                             frame_indices::Union{Array, OrdinalRange, Colon}       = :,
                             first_atom_indices::Union{Array, OrdinalRange, Colon}  = :,
                             second_atom_indices::Union{Array, OrdinalRange, Colon} = first_atom_indices)
::Vector{Matrix{Bool}}</code></pre><p>Multi-threads version of contact<em>bool</em>matrix. If you set available threads number to <code>Threads.nthreads()</code>, this function would faster than non-parallel version.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L203-L211">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MolHandler.contact_probability_matrix_parallel" href="#MolHandler.contact_probability_matrix_parallel"><code>MolHandler.contact_probability_matrix_parallel</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">contact_probability_matrix_parallel(threshold::Real, trj::Trajectory;
                                    frame_indices::Union{Array, OrdinalRange, Colon}       = :,
                                    first_atom_indices::Union{Array, OrdinalRange, Colon}  = :,
                                    second_atom_indices::Union{Array, OrdinalRange, Colon} = first_atom_indices)
::Matrix{Real}</code></pre><p>Multi-threads version of contact<em>probability</em>matrix. If you set available threads number to <code>Threads.nthreads()</code>, this function would faster than non-parallel version.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/yutakasi634/MolHandler.jl/blob/28c0a3745c784880a78550d97b78f07e7c069e4e/src/handling.jl#L303-L311">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Top</a><a class="docs-footer-nextpage" href="../structs/">Structs »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 15 October 2020 12:16">Thursday 15 October 2020</span>. Using Julia version 1.2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
